<html lang="en">
  <%- include("./partials/head.ejs") %>
  <body>
    <%- include("./partials/nav.ejs") %>

    <main class="container">
      <h2>Admin Dashboard</h2>
      <a href="/admin/blogs/create" class="btn" style="margin-bottom: 20px"
        >+ New Blog</a
      >
      <a href="/gallery" class="btn" style="margin-bottom: 20px"
        >+ Upload Photos</a
      >
      <!-- ✅ FIXED -->

      <% if (blogs.length > 0) { %>
      <div class="grid-3">
        <% blogs.forEach(blog => { %>
        <div class="card">
          <div
            class="card-image"
            data-bg="<%= blog.image ? '/uploads/' + blog.image : 'https://via.placeholder.com/200x150.png?text=No+Image' %>"
          ></div>

          <div class="card-content">
            <h3><%= blog.title %></h3>
            <p class="snippet"><%= blog.snippet %></p>

            <!-- View (optional for admin, can link to edit instead) -->
            <!-- <a href="/admin/blogs/<%= blog._id %>/edit" class="btn">Edit</a> -->

            <!-- ✅ FIXED: delete via /admin/blogs/:id -->
            <form
              action="/admin/blogs/<%= blog._id %>?_method=DELETE"
              method="POST"
              style="display: inline"
            >
              <a href="#" class="delete" data-doc="<%= blog._id %>">
                <img
                  src="/trash.png"
                  alt="delete"
                  style="width: 18px; vertical-align: middle; margin-right: 6px"
                /></a>
            </form>
          </div>
        </div>
        <% }) %>
      </div>
      <% } else { %>
      <p>No blogs created yet.</p>
      <% } %>
    </main>
    <%- include("./partials/footer.ejs") %>
  </body>
</html>
